!function(){"use strict";angular.module("AngularSvgNodes",[])}(),function(){"use strict";var a=function(){return{link:function(a,b,c){c.$observe("svgVbox",function(a){b[0].setAttribute("viewBox",a)})}}};angular.module("AngularSvgNodes").directive("svgVbox",a)}(),function(){"use strict";var a=function(){return{restrict:"EA",scope:{index:"@angularSvgNodesBgColGridIndex",onMouseOver:"&angularSvgNodesBgColGridOnMouseOver"},link:function(a,b){b[0].addEventListener("mouseover",function(){var b=_.parseInt(a.index);a.onMouseOver({index:b})})}}};angular.module("AngularSvgNodes").directive("angularSvgNodesBgColGrid",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=this;this.api=a.api||{};var t=!1;this.blocks_waiting_for_connection=[],this.parent_coords=[],this.coords=[],this.blocks=[],this.bg_col_grid=[],this.bg_col_grid_hover_index=null,this.block_width=k,this.block_height=l,this.col_spacing=m,this.row_spacing=n,this.grid_col_count=i,this.grid_row_count=j,this.label_width=k-2*o,this.label_height=l-2*o,this.wrapper_style="",this.viewport_style="",this.viewport_width=0,this.viewport_height=0,this.viewport_viewbox="",this.selection=[],this.source_exit_side=null,this.onNodeSelect=function(b,c){return _.isUndefined(a.onNodeMouseDown)||a.onNodeMouseDown(s.getExternalNodeEventHandlerData(b,c)),s.blocks[c].columns[b].control?(p||this.onControlNodeSelect(b,c),!0):void this.onBlockNodeSelect(b,c)},this.onNodeDeselect=function(b,c){return _.isUndefined(a.onNodeMouseUp)||a.onNodeMouseUp(s.getExternalNodeEventHandlerData(b,c)),s.blocks[c].columns[b].control?!1:void this.onBlockNodeDeselect(b,c)},this.onNodeMouseOver=function(a,b){return s.blocks[b].columns[a].control?(s.onControlNodeMouseOver(a,b),!0):void s.onBlockNodeMouseOver(a,b)},this.onNodeMouseOut=function(a,b,c){return s.blocks[b].columns[a].control?(s.onControlNodeMouseOut(a,b),!0):void s.onBlockNodeMouseOut(a,b,c)},this.onControlNodeSelect=function(b,c){s.addBlock(b,c,"NEW",[]),a.$apply()},this.onControlNodeMouseOver=function(b,c){return s.selection.length>0?!1:(s.setNodeClass(b,c,"control_hover",!0),void a.$apply())},this.onControlNodeMouseOut=function(b,c){return s.selection.length>0?!1:(s.setNodeClass(b,c,"control_hover",!1),void a.$apply())},this.onBlockNodeSelect=function(b,c){s.setNodeClass(b,c,"source_hover",!1),s.setNodeClass(b,c,"source",!0),s.setPotentialNodeClasses(b,c,"potential_target_hover",!1),s.setPotentialNodeClasses(b,c,"potential_target",!0),s.selection=[[b,c]],a.$apply()},this.onBlockNodeDeselect=function(a,b){if(s.source_exit_side=null,1===s.selection.length?_.isEqual(s.selection[0],[a,b])&&(s.setNodeClass(a,b,"source",!1),s.setNodeClass(a,b,"source_hover",!0),s.setPotentialNodeClasses(a,b,"potential_target",!1),s.setPotentialNodeClasses(a,b,"potential_target_hover",!0)):2===s.selection.length&&_.isEqual(s.selection[1],[a,b])&&(s.setNodeClass(a,b,"target",!1),s.doesNodeHaveConnectedParents(a,b)||s.setPotentialNodeClasses(a,b,"potential_target",!1),s.checkActive()),2===s.selection.length&&_.isEqual(s.selection[1],[a,b])&&s.isNodePotential(s.selection[0],[a,b])){var c=s.selection[0][1]>b;c?s.removeLine(s.selection[1],s.selection[0]):(s.setAsConnectedLines(s.selection),s.checkActive())}},this.onBlockNodeMouseOver=function(b,c){0===s.selection.length&&(s.setNodeClass(b,c,"source_hover",!0),s.setPotentialNodeClasses(b,c,"potential_target_hover",!0)),2===s.selection.length&&s.isNodePotential(s.selection[0],[b,c])&&(s.setNodeClass(b,c,"potential_target",!1),s.setNodeClass(b,c,"target",!0),s.setLineClass(s.selection[0],[b,c],"target",!0)),s.bg_col_grid_hover_index!==b,a.$apply()},this.onBlockNodeMouseOut=function(b,c,d){if(0===s.selection.length?(s.setNodeClass(b,c,"source_hover",!1),s.setPotentialNodeClasses(b,c,"potential_target_hover",!1)):2===s.selection.length&&s.isNodePotential(s.selection[0],[b,c])&&(s.setNodeClass(b,c,"target",!1),s.setNodeClass(b,c,"potential_target",!0),s.setLineClass(s.selection[0],[b,c],"target",!1)),_.isEqual(s.selection[0],[b,c])&&_.isNull(s.source_exit_side)&&("top"===d?s.setPotentialChildNodeClasses(b,c,"potential_target",!1):"bottom"===d&&s.setPotentialParentNodeClasses(b,c,"potential_target",!1)),1===s.selection.length){_.isEqual(s.selection[0],[b,c])&&(s.source_exit_side=d);var e;if("top"===d)e=[s.bg_col_grid_hover_index,c-1],s.isNodePotential([b,c],e)&&s.selection.push(e);else if("bottom"===d){var f=c+1;e=[s.bg_col_grid_hover_index,f],Math.abs(s.selection[0][1]-f)<=1&&s.isNodePotential([b,c],e)&&s.selection.push(e)}}a.$apply()},this.onRootDeselect=function(){return s.source_exit_side=null,0===s.selection.length?!0:(s.selection.length>0&&(s.setNodeClass(s.selection[0][0],s.selection[0][1],"source",!1),s.setPotentialNodeClasses(s.selection[0][0],s.selection[0][1],"target",!1),s.setPotentialNodeClasses(s.selection[0][0],s.selection[0][1],"potential_target",!1)),2===s.selection.length&&s.removeUnconnectedLines(s.selection),s.selection.length>0&&(s.selection=[]),void a.$apply())},this.onBgColGridMouseOver=function(b){if(s.bg_col_grid_hover_index===b)return!0;if(s.bg_col_grid_hover_index=b,1===s.selection.length){var c="top"===s.source_exit_side?[b,s.selection[0][1]-1]:[b,s.selection[0][1]+1];s.isNodePotential(s.selection[0],c)&&s.selection.push(c)}else 2===s.selection.length&&s.isNodePotential(s.selection[0],[b,s.selection[1][1]])&&(s.selection[1][0]=b);a.$apply()},this.onRootMouseLeave=function(){1===s.selection.length?(s.setNodeClass(s.selection[0][0],s.selection[0][1],"source",!1),s.setPotentialNodeClasses(s.selection[0][0],s.selection[0][1],"potential_target",!1)):2===s.selection.length&&(s.setNodeClass(s.selection[0][0],s.selection[0][1],"source",!1),s.setNodeClass(s.selection[1][0],s.selection[1][1],"target",!1),s.setPotentialNodeClasses(s.selection[0][0],s.selection[0][1],"potential_target",!1)),2===s.selection.length&&s.removeUnconnectedLines(s.selection),s.selection=[],a.$apply()},this.onLineRemoveComplete=function(b,c,d){var e=s.blocks[b[1]].columns[b[0]];e.lines.splice(d,1),0===e.lines.length&&(s.doesNodeHaveConnectedParents(b[0],b[1])||s.setAsNotConnectedBlock([b[0],b[1]])),_.isUndefined(a.onLineRemove)||a.onLineRemove(s.getExternalLineEventHandlerData(b,c,d)),a.$apply()},this.onLineDrawComplete=function(b,c){var d=!1;_.forEach(s.blocks_waiting_for_connection,function(a,b){return _.isEqual(a,c)?(d=!0,s.blocks_waiting_for_connection.splice(b,1),!1):void 0}),d&&s.setAsConnectedBlock(c),a.$apply()},this.getExternalNodeEventHandlerData=function(b,c){var d=_.clone(a.rows[c].columns[b]),e=_.clone(s.blocks[c].columns[b]),f={node:e,data:null};return _.isUndefined(d)||(f.data=d),f},this.getExternalLineEventHandlerData=function(a,b,c){var d=s.getExternalNodeEventHandlerData(a[0],a[1]),e=s.getExternalNodeEventHandlerData(b[0],b[1]);return{source_node:d.node,source_data:d.data,target_node:e.node,target_data:e.data,line_index:c}},this.checkActive=function(){return 0===s.blocks.length?!1:void _.forEach(s.blocks[0].columns,function(a,b){a.lines.length>0&&s.activateBlock(b,0)})},this.activateBlock=function(a,b){var c=s.blocks[b].columns[a];c.active=!0,c.lines.length>0&&_.forEach(c.lines,function(a){a.active=!0,s.activateBlock(a.to[0],a.to[1])})},this.deactivateBlock=function(a,b){var c=s.blocks[b].columns[a];c.active=!1,c.lines.length>0&&_.forEach(c.lines,function(a){a.active=!1;var b=s.doesNodeHaveActiveParents(a.to[0],a.to[1]);b||s.deactivateBlock(a.to[0],a.to[1])})},this.doesNodeHaveActiveParents=function(a,b,c){if(0===b)return!1;var d=!1,e=b-1,f=s.blocks[e].columns;return _.forEach(f,function(f,g){_.forEach(f.lines,function(h){!_.isEqual([g,e],c)&&_.isEqual(h.to,[a,b])&&f.active&&(d=!0)})}),d},this.doesNodeHaveConnectedParents=function(a,b,c){if(0===b)return!1;_.isUndefined(c)&&(c=[]);var d=!1,e=b-1,f=s.blocks[e].columns;return _.forEach(f,function(f,g){return!_.isEqual([g,e],c)&&s.isNodePotential([a,b],[g,e])?(d=!0,!1):void 0}),d},this.isNodePotential=function(a,b){if(_.isUndefined(s.blocks[b[1]]))return!1;if(_.isUndefined(s.blocks[b[1]].columns[b[0]]))return!1;if(s.blocks[b[1]].columns[b[0]].control)return!1;if(a[1]===b[1])return!1;if(Math.abs(a[1]-b[1])>1)return!1;if(b[1]>=s.blocks.length)return!1;if(b[0]>=s.blocks[b[1]].columns.length)return!1;var c,d=b[1]<a[1],e=s.blocks[a[1]].columns[a[0]],f=s.blocks[b[1]].columns[b[0]];if(d){if(c=!1,"bottom"===s.source_exit_side)return!1;_.forEach(f.lines,function(b){return b.connected&&_.isEqual(b.to,a)?(c=!0,!1):void 0})}else{if(c=!0,"top"===s.source_exit_side)return!1;_.forEach(e.lines,function(a){return a.connected&&_.isEqual(a.to,b)?(c=!1,!1):void 0})}return c},this.setLineClass=function(a,b,c,d){_.forEach(s.blocks[a[1]].columns[a[0]].lines,function(a){_.isEqual(a.to,b)&&(a[c]=d)})},this.setNodeClass=function(a,b,c,d){s.blocks[b].columns[a][c]=d},this.setPotentialNodeClasses=function(a,b,c,d){s.setPotentialChildNodeClasses(a,b,c,d),s.setPotentialParentNodeClasses(a,b,c,d)},this.setPotentialChildNodeClasses=function(a,b,c,d){b+1<s.blocks.length&&_.forEach(s.blocks[b+1].columns,function(e,f){s.isNodePotential([a,b],[f,b+1])&&(e[c]=d)})},this.setPotentialParentNodeClasses=function(a,b,c,d){b>0&&_.forEach(s.blocks[b-1].columns,function(e,f){s.isNodePotential([a,b],[f,b-1])&&(e[c]=d)})},this.setViewport=function(a,b){var c=k+m,d=l+n;s.viewport_width=c*a,s.viewport_height=d*b,s.viewport_style={"background-color":"#ccc","min-width":s.viewport_width+"px","min-height":s.viewport_height+"px"},s.wrapper_style={"max-width":s.viewport_width+q+"px","min-width":s.viewport_width+"px","max-height":s.viewport_height+r*b+"px","min-height":s.viewport_height+"px"},s.viewport_viewbox=" 0 0 "+s.viewport_width+" "+s.viewport_height},this.checkViewport=function(a,b){var c=!1;b>=s.grid_row_count&&(s.grid_row_count++,c=!0),a>=s.grid_col_count&&(s.grid_col_count++,c=!0,s.addBgGridCol(s.grid_col_count-1)),c&&s.setViewport(s.grid_col_count,s.grid_row_count)},this.calculateColX=function(a){if(0===a)return 0;var b=k+m/2,c=k+m;return b+(a-1)*c},this.calculateColWidth=function(a){var b=0===a?k+m/2:k+m;return b},this.calculateRowY=function(a){var b=l+n;return a*b},this.calculateRowHeight=function(){return l+n},this.getCoords=function(a,f,g){var h=k+m,i=l+n,j=(a+1)*h-h,o=(f+1)*i-i,p=null;switch(g){case b:p=[j,o];break;case c:j+=k/2,p=[j,o];break;case d:j+=k/2,o+=l/2,p=[j,o];break;case e:j+=k/2,o+=l,p=[j,o]}return p},this.addLine=function(a,b,d){if(b[1]>=s.blocks.length)return!1;var f=s.getCoords(a[0],a[1],e),g=s.getCoords(b[0],b[1],c);s.blocks[a[1]].columns[a[0]].lines.push({connected:_.isUndefined(d)?!1:d,from:a,to:b,x1:f[0],y1:f[1],x2:g[0],y2:g[1]})},this.updateLineTarget=function(a,b){var d=s.getCoords(b[0],b[1],c);_.forEach(s.blocks[a[1]].columns[a[0]].lines,function(c){return _.isEqual(c.from,a)&&_.isEqual(c.to,b)?(c.x2=d[0],c.y2=d[1],c.to=b,!1):void 0})},this.removeLine=function(a,b){var c=s.getCoords(a[0],a[1],e);_.forEach(s.blocks[a[1]].columns[a[0]].lines,function(d){if(_.isEqual(d.from,a)&&_.isEqual(d.to,b)){var e=s.blocks[b[1]].columns[b[0]],f=s.doesNodeHaveConnectedParents(b[0],b[1],a);0!==e.lines.length||f||s.setAsNotConnectedBlock(b);var g=s.doesNodeHaveActiveParents(b[0],b[1],a);return g||s.deactivateBlock(b[0],b[1]),d.x2=c[0],d.y2=c[1],d.previous_to=d.to,d.to=[a[0],a[1]],!1}})},this.removeUnconnectedLines=function(a){_.forEach(s.blocks[a[0][1]].columns[a[0][0]].lines,function(a){a.connected||(console.onMoveLineTargetComplete("CLEAN"),s.removeLine(s.selection[0],s.selection[1]))})},this.setAsConnectedLines=function(b){_.forEach(s.blocks[b[0][1]].columns[b[0][0]].lines,function(b,c){b.connected||(b.connected=!0,s.setAsConnectedBlock(b.from),s.setAsConnectedBlock(b.to),_.isUndefined(a.onLineAdd)||a.onLineAdd(s.getExternalLineEventHandlerData(b.from,b.to,c)))})},this.setAsConnectedBlock=function(a){s.blocks[a[1]].columns[a[0]].connected=!0},this.setAsNotConnectedBlock=function(a){s.blocks[a[1]].columns[a[0]].connected=!1},this.addBlock=function(a,d,f,g){if(d>s.blocks.length)throw new Error("Invalid row index");d===s.blocks.length&&s.blocks.push({columns:[]});var h;_.isUndefined(s.blocks[d].columns[a])||(h=s.blocks[d].columns.splice(a,1));var i=s.getCoords(a,d,b),j=[],k=s.getCoords(a,d,e);_.forEach(g,function(b){var e=[b,d+1],f=s.getCoords(e[0],e[1],c);j.push({connected:!0,from:[a,d],to:e,x1:k[0],y1:k[1],x2:f[0],y2:f[1]}),s.blocks_waiting_for_connection.push(e)});var l={coords:i,x:i[0],y:i[1],label_x:i[0]+o,label_y:i[1]+o,label:f,connected:j.length>0,control:!1,row_index:d,col_index:a,lines:j};s.blocks[d].columns.push(l),s.checkViewport(a,d),_.isUndefined(h)||s.addControl(h[0].row_index)},this.updateBlock=function(a,b,c){_.isUndefined(c)||s.blocks[b].columns[a].label===c||(s.blocks[b].columns[a].label=c)},this.removeBlock=function(b,c){if(c>=s.blocks.length)return!0;if(b>=s.blocks[c].columns.length-1)return!0;s.blocks[c].columns.splice(b,1),a.rows[c].columns.splice(b,1);for(var d=b;d<s.blocks[c].columns.length;d++)s.updateBlockAfterSiblingAddedOrRemoved(d,c)},this.insertBlock=function(d,f,g){if(f>=s.blocks.length)return!0;if(d>s.blocks[f].columns.length-1)return!0;var h=s.getCoords(d,f,b),i=[],j=s.getCoords(d,f,e);_.forEach(g.join,function(a){var b=[a,f+1],e=s.getCoords(b[0],b[1],c);i.push({connected:!0,from:[d,f],to:b,x1:j[0],y1:j[1],x2:e[0],y2:e[1]}),s.blocks_waiting_for_connection.push(b)});var k={coords:h,x:h[0],y:h[1],label_x:h[0]+o,label_y:h[1]+o,label:g.label,connected:i.length>0,control:!1,row_index:f,col_index:d,lines:i};s.blocks[f].columns.splice(d,0,k),a.rows[f].columns.splice(d,0,g);for(var l=d+1;l<s.blocks[f].columns.length;l++)s.updateBlockAfterSiblingAddedOrRemoved(l,f)},this.updateBlockAfterSiblingAddedOrRemoved=function(a,e){var f=s.getCoords(a,e,b),g=s.getCoords(a,e,d);s.blocks[e].columns[a].col_index=a,s.blocks[e].columns[a].coords=f,s.blocks[e].columns[a].x=f[0],s.blocks[e].columns[a].y=f[1],a===s.blocks[e].columns.length-1?(s.blocks[e].columns[a].label_x=g[0],s.blocks[e].columns[a].label_y=g[1]):(s.blocks[e].columns[a].label_x=f[0]+o,s.blocks[e].columns[a].label_y=f[1]+o),_.forEach(s.blocks[e].columns[a].lines,function(b){var d=s.getCoords(a,e,c);b.from=[a,e],b.x1=d[0],b.y1=d[1]}),s.checkViewport(a,e)},this.addControl=function(a){if(a===s.blocks.length&&s.blocks.push({columns:[]}),a>=s.blocks.length)throw new Error("Invalid row index");var c=s.blocks[a].columns.length,e=s.getCoords(c,a,b),f=s.getCoords(c,a,d),g={coords:e,x:e[0],y:e[1],label_x:f[0],label_y:f[1],label:"+",connected:!1,control:!0,row_index:a,col_index:c,lines:[]};s.blocks[a].columns.push(g),s.checkViewport(c,a)},this.addBgGridCol=function(a){s.bg_col_grid.push({index:a,x:s.calculateColX(a),width:s.calculateColWidth(a)})},a.$watch("ctrl.selection",function(a,b){_.isUndefined(a)||2===a.length&&a[1][1]>a[0][1]&&(a.length>b.length?s.addLine(s.selection[0],s.selection[1]):s.updateLineTarget(s.selection[0],s.selection[1]))},!0),a.$watch("rows",function(a){if(!_.isUndefined(a)){if(!t)return s.init(a,"columns"),t=!0,!0;s.update(a,"columns")}},!0),this.init=function(a,b){for(var c=0;j>c;c++)c>=a.length&&a.push({columns:[]});_.forEach(a,function(a,c){_.forEach(a[b],function(a,b){s.addBlock(b,c,a.label,a.join)}),s.addControl(c)}),_.map(new Array(s.grid_col_count),function(a,b){s.addBgGridCol(b)}),s.setViewport(s.grid_col_count,s.grid_row_count),s.checkActive()},this.update=function(a,b){_.forEach(a,function(a,b){b>=s.blocks.length&&s.addControl(b)}),_.forEach(a,function(a,c){_.forEach(a[b],function(a,b){if(s.updateBlock(b,c,a.label),b>=s.blocks[c].columns.length-1){var d=_.has(a,"label")?a.label:"",e=_.has(a,"join")?a.join:[];s.addBlock(b,c,d,e)}})}),s.setViewport(s.grid_col_count,s.grid_row_count),s.checkActive()},this.api.insertBlock=function(a,b,c){s.insertBlock(a,b,c)},this.api.removeBlock=function(a,b){s.removeBlock(a,b)}};a.$inject=["$scope","BLOCK_TOP_LEFT","BLOCK_TOP","BLOCK_CENTER","BLOCK_BOTTOM","ACTION_ADD","ACTION_REMOVE","ACTION_UPDATE","INITIAL_GRID_COLS","INITIAL_GRID_ROWS","BLOCK_WIDTH","BLOCK_HEIGHT","COL_SPACING","ROW_SPACING","LABEL_SPACING","DISABLE_CONTROL_NODES","MAX_VIEWPORT_WIDTH_INCREASE","MAX_VIEWPORT_HEIGHT_INCREASE"],angular.module("AngularSvgNodes").controller("AngularSvgNodesController",a)}(),function(){"use strict";var a=function(){return{restrict:"EA",scope:{rows:"=angularSvgNodes",onNodeMouseDown:"&angularSvgNodesNodeMouseDown",onNodeMouseUp:"&angularSvgNodesNodeMouseUp",onLineAdd:"&angularSvgNodesLineAdd",onLineRemove:"&angularSvgNodesLineRemove",api:"=angularSvgNodesApi"},replace:!0,controller:"AngularSvgNodesController as ctrl",link:function(a,b,c,d){d.parent_coords=b[0].getBoundingClientRect(),b.addClass("angular-svg-nodes"),b[0].addEventListener("mouseup",d.onRootDeselect),b[0].addEventListener("mouseleave",d.onRootMouseLeave)},templateUrl:"views/angular-svg-nodes.html"}};angular.module("AngularSvgNodes").directive("angularSvgNodes",a)}(),function(){"use strict";var a=function(){return{restrict:"EA",scope:{coords:"=angularSvgNodesLineCoords",col_index:"@angularSvgNodesLineColIndex",row_index:"@angularSvgNodesLineRowIndex",line_index:"@angularSvgNodesLineLineIndex",onRemoveComplete:"&angularSvgNodesLineOnRemoveComplete",onMoveLineTargetComplete:"&angularSvgNodesLineonMoveLineTargetComplete",onDrawComplete:"&angularSvgNodesLineOnDrawComplete"},link:function(a,b){var c,d,e,f=.5,g=!1,h=function(){var b=_.parseInt(a.line_index);a.onRemoveComplete({source_coords:c,target_coords:e,line_index:b})},i=function(){var b=_.parseInt(a.line_index);a.onMoveLineTargetComplete({source_coords:c,target_coords:d,line_index:b})},j=function(){},k=function(){var b=_.parseInt(a.line_index);a.onDrawComplete({source_coords:c,target_coords:d,line_index:b})};a.removeLineTarget=function(a,c){TweenLite.to(b,f,{attr:{x2:a,y2:c},ease:Power4.easeOut,onComplete:h})},a.moveLineTarget=function(a){TweenLite.to(b,f,{attr:{x2:a},ease:Power4.easeOut,onComplete:i})},a.moveLineSource=function(a){TweenLite.to(b,f,{attr:{x1:a},ease:Power4.easeOut,onComplete:j})},a.drawLine=function(a,c,d,e){TweenLite.set(b,{attr:{x1:a,y1:c,x2:a,y2:c}}),TweenLite.to(b,f,{attr:{x2:d,y2:e},ease:Power4.easeOut,onComplete:k})},a.$watch("coords",function(b,f){_.isUndefined(b)||(c=b.from,d=b.to,e=b.previous_to,g?f.to[1]===b.to[1]&&f.to[0]!==b.to[0]?a.moveLineTarget(b.x2):f.to[0]===b.to[0]&&f.to[1]!==b.to[1]?a.removeLineTarget(b.x2,b.y2):f.to[1]!==b.to[1]&&f.to[0]!==b.to[0]?b.to[1]<f.to[1]&&a.removeLineTarget(b.x2,b.y2):f.from[0]!==b.from[0]&&a.moveLineSource(b.x1):(a.drawLine(b.x1,b.y1,b.x2,b.y2),g=!0))},!0)}}};angular.module("AngularSvgNodes").directive("angularSvgNodesLine",a)}(),function(){"use strict";var a=function(){return{restrict:"EA",scope:{coords:"=angularSvgNodesNodeCoords",col_index:"@angularSvgNodesNodeColIndex",row_index:"@angularSvgNodesNodeRowIndex",onSelect:"&angularSvgNodesNodeOnSelect",onDeselect:"&angularSvgNodesNodeOnDeselect",onMouseOver:"&angularSvgNodesNodeOnMouseOver",onMouseOut:"&angularSvgNodesNodeOnMouseOut"},link:function(a,b){var c=null,d=.2;b[0].addEventListener("mousedown",function(){var b=_.parseInt(a.col_index),c=_.parseInt(a.row_index);a.onSelect({col_index:b,row_index:c})}),b[0].addEventListener("mouseover",function(){var b=_.parseInt(a.col_index),c=_.parseInt(a.row_index);a.onMouseOver({col_index:b,row_index:c})}),b[0].addEventListener("mouseout",function(c){var d=b[0].getBoundingClientRect(),e=c.clientY,f=d.top+d.height/2,g=_.parseInt(a.col_index),h=_.parseInt(a.row_index),i=f>e?"top":"bottom";a.onMouseOut({col_index:g,row_index:h,exit_side:i})}),b[0].addEventListener("mouseup",function(){var b=_.parseInt(a.col_index),c=_.parseInt(a.row_index);a.onDeselect({col_index:b,row_index:c})});var e=function(){};a.$watch("coords",function(a){if(!_.isUndefined(a)){var f=_.isNull(c)?0:d;TweenLite.to(b,f,{x:a[0],y:a[1],ease:Power4.easeOut,onComplete:e}),c=a[0]}})}}};angular.module("AngularSvgNodes").directive("angularSvgNodesNode",a)}(),function(){"use strict";angular.module("AngularSvgNodes").constant("BLOCK_TOP_LEFT",0).constant("BLOCK_TOP",1).constant("BLOCK_CENTER",2).constant("BLOCK_BOTTOM",3).constant("ACTION_ADD",0).constant("ACTION_REMOVE",1).constant("ACTION_UPDATE",2).constant("INITIAL_GRID_COLS",4).constant("INITIAL_GRID_ROWS",2).constant("BLOCK_WIDTH",80).constant("BLOCK_HEIGHT",80).constant("COL_SPACING",20).constant("ROW_SPACING",40).constant("LABEL_SPACING",5).constant("DISABLE_CONTROL_NODES",!0).constant("MAX_VIEWPORT_WIDTH_INCREASE",100).constant("MAX_VIEWPORT_HEIGHT_INCREASE",100)}(),angular.module("AngularSvgNodes").run(["$templateCache",function(a){"use strict";a.put("views/angular-svg-nodes.html",'<div class="angular-svg-nodes" ng-style="ctrl.wrapper_style">\n\n    <svg version="1.1" xmlns="http://www.w3.org/2000/svg"\n         preserveAspectRatio="xMinYMin meet"\n         ng-style="viewport_style"\n         width="100%"\n         svg-vbox="{{ctrl.viewport_viewbox}}">\n\n        <!-- bg column grid -->\n\n        <svg ng-repeat="col in ctrl.bg_col_grid">\n\n            <rect ng-attr-x="{{col.x}}" y="0"\n                  ng-attr-width="{{col.width}}"\n                  height="100%"\n                  class="angular-svg-nodes-bg-col-grid-col"\n                  angular-svg-nodes-bg-col-grid\n                  angular-svg-nodes-bg-col-grid-index="{{col.index}}"\n                  angular-svg-nodes-bg-col-grid-on-mouse-over="ctrl.onBgColGridMouseOver(index)"></rect>\n        </svg>\n\n        <!-- rows -->\n\n        <svg ng-repeat="row in ctrl.blocks" x="0" y="0">\n\n            <!-- columns -->\n\n            <svg ng-repeat="col in row.columns" class="angular-svg-nodes-col">\n\n                <!-- lines -->\n\n                <line ng-repeat="line in col.lines"\n                      class="angular-svg-nodes-line"\n                      ng-class="{\n                      \'connected\': line.connected,\n                      \'active\': line.active,\n                      \'target\': line.target,\n                      \'potential_remove\': line.potential_remove\n                      }"\n                      angular-svg-nodes-line\n                      angular-svg-nodes-line-coords="line"\n                      angular-svg-nodes-line-col-index="{{col.col_index}}"\n                      angular-svg-nodes-line-row-index="{{col.row_index}}"\n                      angular-svg-nodes-line-line-index="{{$index}}"\n                      angular-svg-nodes-line-on-remove-complete="ctrl.onLineRemoveComplete(source_coords, target_coords, line_index)"\n                      angular-svg-nodes-line-on-draw-complete="ctrl.onLineDrawComplete(source_coords, target_coords, line_index)"></line>\n\n                <!-- blocks -->\n\n                <rect ng-attr-width="{{ctrl.block_width}}" ng-attr-height="{{ctrl.block_height}}"\n                      class="angular-svg-nodes-node"\n                      ng-class="{\n                      \'connected\': col.connected,\n                      \'active\': col.active,\n                      \'source\': col.source,\n                      \'source-hover\': col.source_hover,\n                      \'target\': col.target,\n                      \'target-hover\': col.target_hover,\n                      \'potential-target\': col.potential_target,\n                      \'potential-target-hover\': col.potential_target_hover,\n                      \'control\': col.control,\n                      \'control-hover\': col.control_hover,\n                      }"\n                      angular-svg-nodes-node\n                      angular-svg-nodes-node-coords="col.coords"\n                      angular-svg-nodes-node-col-index="{{col.col_index}}"\n                      angular-svg-nodes-node-row-index="{{col.row_index}}"\n                      angular-svg-nodes-node-on-select="ctrl.onNodeSelect(col_index, row_index)"\n                      angular-svg-nodes-node-on-deselect="ctrl.onNodeDeselect(col_index, row_index)"\n                      angular-svg-nodes-node-on-mouse-out="ctrl.onNodeMouseOut(col_index, row_index, exit_side)"\n                      angular-svg-nodes-node-on-mouse-over="ctrl.onNodeMouseOver(col_index, row_index)"></rect>\n\n                <!-- control label -->\n\n                <text ng-show="col.control"\n                      class="angular-svg-nodes-node-label"\n                      ng-class="{\n                      \'control\': col.control,\n                      \'control_hover\': col.control_hover,\n                      }"\n                      ng-attr-x="{{col.label_x}}" ng-attr-y="{{col.label_y}}"\n                      angular-svg-nodes-label\n                      angular-svg-nodes-label-coords="col"\n                      text-anchor="middle" alignment-baseline="middle">+</text>\n\n                <!-- label -->\n\n                <foreignObject ng-show="!col.control"\n                               angular-svg-nodes-label\n                               angular-svg-nodes-label-coords="col"\n                               ng-attr-x="{{col.label_x}}" ng-attr-y="{{col.label_y}}"\n                               ng-attr-width="{{ctrl.label_width}}" ng-attr-height="{{ctrl.label_height}}"\n                               class="angular-svg-nodes-node-label-foreign-object">\n                    <div xmlns="http://www.w3.org/1999/xhtml" class="angular-svg-nodes-node-label noselect">{{col.label}}</div>\n                </foreignObject>\n\n            </svg>\n        </svg>\n\n        <!--<text x="600" y="200"\n              style="font-size: 20px; color: #000;"\n              text-anchor="middle" alignment-baseline="middle">{{ctrl.selection}}</text>-->\n\n    </svg>\n</div>\n')}]);
//# sourceMappingURL=angular-svg-nodes.tmpl.min.js.map